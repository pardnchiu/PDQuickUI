!function(){"use strict";(()=>{const e=document,t=String,n=/\{\{\s*(((CALC|LENGTH|UPPER|LOWER|DATE)\(\s*[\w\.\s\+\-\*\/\,\s\/\:]+\s*\))|[\w\.]+)\s*\}\}/i,s=new RegExp(n,"gi"),l=/(CALC|LENGTH|UPPER|LOWER)\(([\w\.]+)\s*([\+\-\*\/\%]+)\s*([\d\.]+)\)/,r=/DATE\(([\w\.]+)\s*,\s*([^\n]+)\)/,i=/^\(?\s*([\w]+)(\s*\,|\s+)?/i,o=/\,\s*([\w]+)\s*\)/i,u=/\s+([\w\.]+)\s*$/i,a=/\s*[\!\>\<\=]+\=*\s*/,c=/([\w\.]+)\s*([\+\-\*\/\%])\s*([\d\.]+)/,T=":path",E=":for",d=":if",h=":else-if",f=":else",A=":model",p=":html",m="parentElement",_="textContent",b="toLowerCase",g="remove",y="alt",I="dom",N="path",L="data",S="event",R="next",O="done",M="trim",w="href",C="src",D="border",B="split",U="Radius",F="padding",Y="margin",G="id",H="isArray",v="style",P="Color",V="Image",$="Size",x="Attachment",j="Mode",X="clip",k="Blend",q="Repeat",W="Origin",z="Position",J="background",Q="innerHTML",K="forEach",Z="value",ee="body",te="nodeType",ne="length",se="match",le="shift",re="isFor",ie="isAry",oe="isObj",ue="filter",ae="TEXT_NODE",ce="addEventListener",Te="dom-tag";function Ee(e){return`*[dom-tag='${e}']`}function de(n="",s,l){const r=/\.([\w_-]+)?/gi,i=((n[se](/^\w+(?=[\#\.]*)/i)||[])[0]||"")[M](),o=((n[se](/\#([\w_-]+)?/i)||[])[1]||"")[M](),u=(r.test(n)&&n.match(r)||[]).map((e=>e.replace(/^\./,"")));if(i[ne]<1)return;let a,c,T,E=!1;"temp"===n?(E=!0,a=e.createDocumentFragment()):a=e.createElement(i),o[ne]&&(a.id=o);for(let e of u)a.classList.add(e);if(null==s&&null!=l&&([s,l]=[l,null]),null!=s&&null!=l)[c,T]=[s,l];else if(null==l)"string"==typeof s||"number"==typeof s||Array[H](s)?T=s:c=s;else if(null==s)return a;if("object"==typeof c&&null!=c)for(const e in c){if(!c.hasOwnProperty(e))continue;const t=c[e];-1!=["value","innerText","innerHTML","textContent","contentEditable"].indexOf(e)?a[e]=t:-1!=["color","backgroundColor","width","height","display","float"].indexOf(e)?a.style[e]=t:null!=t&&a.setAttribute(e,t)}if(null!=T){const n="string"==typeof T,s="number"==typeof T,l=Array[H](T);if(n||s){const t=T;"img"===i||"source"===i?a.src=t:E?a.appendChild(e.createTextNode(T)):a.innerHTML=t}else if(l)for(let n of T){const s=n instanceof Element;"string"==typeof n||"number"==typeof n?E?a.appendChild(e.createTextNode(t(n))):a.innerHTML+=n:s&&a.appendChild(n)}}return a}function he(e){if(null==e)return;let t=0,n=e;for(;null!=(n=n.previousElementSibling);)t++;return t}window.QUI=class{dom;path;data;event;done={};#e={};#t(e){const t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let n="";do{n=Array.from({length:e},(()=>t.charAt(Math.floor(62*Math.random())))).join("")}while(null!=this.#e[n]);return this.#e[n]=1,n}#n(e){let t=new Map;for(let n of e.attributes)t.set(n.name,n.value.trim());return Object.fromEntries(t)}constructor(t={}){const n="string"==typeof t[G]?e.getElementById(t[G]):null;if(!(n instanceof Element))return;this[I]=n,this[N]={},this[L]=t[L],this[S]=t[S]||{};const s=Date.now();this.#s(n,t[L]||{}).then((e=>{const n=Date.now()-s;null!=t[R]&&(console.log("Rendered, took "+n/1e3+" seconds"),t[R](this[I]))}))}#l(e,t,n){return e=Number(e),n=Number(n),isNaN(e)||isNaN(n)?void 0:"+"===t?e+n:"-"===t?e-n:"*"===t?e*n:"/"===t?e/n:"%"===t?e%n:e}#r(e,t,n){let s=t[e];null==s||"object"!=typeof s||null==s||Array[H](s)?null!=s&&Object.defineProperty(t,e,{get:()=>s,set:e=>{s=e,n(e)}}):Object.keys(s)[K]((e=>{this.#r(e,s,n)}))}#i=async(t,n={},s={})=>{const l=t.parentElement,r=this.#n(t)[T];if(null!=l&&null!=r){if(null==this[N][r])this[N][r]=l;else if(this[N][r]==l)return;fetch(r).then((async r=>{const i=await r.text();[...(de("div",i)||{}).childNodes||[]][K]((e=>{t.appendChild(e)})),/new\s+PD/.test(i)||this.#s(t,n,s),[...t.childNodes][K]((n=>{if(n instanceof HTMLScriptElement){let t=de("script",n.innerHTML);if(null==t)return;e[ee].appendChild(t)}else l.insertBefore(n,t)})),t[g]()})).catch((()=>{t[g]()}))}};#o=(e,n={},s={})=>{const l=e.parentElement,r=he(e);if(null==r)return;const i=(e.getAttribute(d)||"")[M](),o=(e.getAttribute(":once")||"")[M](),u=Boolean(isNaN(parseInt(o))?o:parseInt(o));if(null==l||i[ne]<1)return;let c,T,E=[e],A=e.nextElementSibling;for(null!=A&&(c=null!=A.getAttribute(h),T=null!=A.getAttribute(f));null!=A&&(c||T);)E.push(A),A=A.nextElementSibling,null!=A&&(c=null!=A.getAttribute(h),T=null!=A.getAttribute(f));const p=this.#t(16),m=de("temp",E.map((e=>{e.cloneNode(!0).setAttribute(Te,p)})));if(null==m)return;let _=!1;E[K]((e=>{if(e.setAttribute(Te,p),_)return e[g]();const s=(e.getAttribute(d)||e.getAttribute(h)||e.getAttribute(f)||"")[M](),i=null!=e.getAttribute(f),o=s[B](a)[0],c=s[B](a)[1],T=((s[se](a)||[])[0]||"")[M](),E=this.#u(o,n,(e=>{u||(l.querySelectorAll(Ee(p))[K]((e=>e[g]())),l.insertBefore(m.cloneNode(!0),l.children[r]),this.#s(l,n,{[re]:!0}))}));T.length<1?_=Boolean(E):">"===T?_=(Number(E)||0)>(Number(c)||0):"<"===T?_=(Number(E)||0)<(Number(c)||0):">="===T||">=="===T?_=(Number(E)||0)>=(Number(c)||0):"<="===T||"<=="===T?_=(Number(E)||0)<=(Number(c)||0):"=="===T||"==="===T?_="null"==c?null==E:"true"==c?Boolean(E):"false"==c?!Boolean(E):"empty"==c?t(E||"")[ne]<1:t(E||"")==t(c):"!="!==T&&"!=="!==T||(_="null"==c?null!=E:"true"==c?!Boolean(E):"false"==c?Boolean(E):"empty"==c?t(E||"")[ne]>0:t(E||"")!=t(c));for(let t of[d,h,f])e.removeAttribute(t);_||i?_&&e.classList.remove("dom-temp"):e[g]()})),this.#s(l,n,s)};#u=(e="",s={},l)=>{if(e[M]()[ne]<1)return;const r=n.test(e);let i="",o="";r&&(i=e[B](n)[0]||"",o=e[B](n)[4]||"",e=e[se](n)[1]);const u=/^LENGTH\(.+\)/.test(e);u&&(e=e.replace(/^LENGTH\(|\)$/g,""));const a=/^CALC\(.*\)$/.test(e);let T="",E=0;if(a){const t=(e=e.replace(/^CALC\(|\)$/g,""))[se](c);e=t[1],T=t[2],E=parseInt(t[3])||0}const d=/^UPPER\(.*\)$/.test(e),h=/^LOWER\(.*\)$/.test(e);(d||h)&&(e=e.replace(/^(UPPER|LOWER)\(|\)$/g,""));const f=/^DATE\([\w\,\-\s\:]*\)$/.test(e);let A="";if(f){const t=(e=e.replace(/^DATE\(|\)$/g,""))[se](/(\w+),\s*([^\n]+)/);e=t[1],A=t[2]}let p=e[B](/\./),m=s,_=p[0],g=m[_];p[le](),g=this.#a(p,m,_,g),null!=l&&this.#r(_,m,(e=>{l(e)}));let y="";if(null!=g&&g instanceof Object&&!Array.isArray(g)?y=t(Object.keys(g)[ne]):null!=g&&(y=g[ne]),r){if(u)return i+y+o;if(a&&(g=this.#l(g,T,E),null==g))return;return i+g+o}if(u)return y;if(a){if(g=this.#l(g,T,E),null==g)return}else{if(d)return g.toUpperCase();if(h)return g[b]();if(f)return function(e,n="yyyy/MM/DD (ddd) HH:mm:ss"){const s=new Date(1e3*e),l=t(s.getFullYear()),r=t(s.getMonth()+1),i=t(s.getDate()),o=t(s.getDay()),u=t(s.getHours()),a=t(s.getMinutes()),c=t(s.getSeconds()),T=t(s.getMilliseconds());let E={YYYY:l,yyyy:l,YY:l.slice(-2),yy:l.slice(-2),Y:l.slice(-2),y:l.slice(-2),M:r,MM:("0"+r).slice(-2),D:i,DD:("0"+i).slice(-2),d:o,dd:("0"+o).slice(-2),H:u,HH:("0"+u).slice(-2),h:t(parseInt(u)%12||12),hh:("0"+(parseInt(u)%12||12)).slice(-2),m:a,mm:("0"+a).slice(-2),s:c,ss:("0"+c).slice(-2),SSS:("00"+T).slice(-3),a:parseInt(u)>=12?"pm":"am",A:parseInt(u)>=12?"PM":"AM"};const d=/zh/.test(navigator.language||"")?["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return E.ddd=d[parseInt(o)].slice(0,3),E.dddd=d[parseInt(o)],n.replace(/YYYY|YY|Y|yyyy|yy|y|MM|M|DD|D|HH|H|hh|h|mm|m|ss|s|SSS|a|A|ddd|dddd/g,(e=>E[e]))}(parseInt(g),A)}return g};#c=(e,t={})=>{const n=e.parentElement,s=(e.getAttribute(A)||"")[M]();e.removeAttribute(A);this.#u(s,t,(e=>{}));if(null==n||null==s||s[M]()[ne]<1)return;const l=e instanceof HTMLInputElement,r=e instanceof HTMLTextAreaElement,i=e instanceof HTMLSelectElement,o=e.getAttribute("type");!l||"checkbox"!==o&&"radio"!==o?i?e[ce]("change",(e=>{t[s]=e.target[Z]})):(l||r)&&(e[ce]("keyup",(e=>{t[s]=e.target[Z]})),e[ce]("change",(e=>{t[s]=e.target[Z]}))):e[ce]("change",(e=>{t[s]=[...document.body.querySelectorAll("input[name='"+e.target.name+"'][type='"+o+"']:checked")].map((e=>e.value)).join(",")}))};#T(t,n={}){const s=t.getAttribute(Te)||"",l=Object.keys(this.#n(t))[ue]((e=>/^:[\w\-]+$/.test(e)))[ue]((e=>!/\:(path|for|if|else\-if|else|model)/.test(e)));l[ne]<1||l[K]((l=>{const r=(t.getAttribute(l)||"")[M](),i=this.#u(r,n,(n=>{const i=[...e[ee].querySelectorAll(Ee(s))];i[ne]<1||i[K]((e=>{this.#E(t,l,n,r)}))}));this.#E(t,l,i,r),t.removeAttribute(l)}))}#E(e,n,s="",l){s=t(s),n[b]()===":class"[b]()&&e.classList.add(s),[[":"+G,G],[":"+C,C],[":"+y,y],[":"+w,w],[p,Q]][K]((t=>{n[b]()===t[0][b]()&&(s[M]()[ne]<1||(e[t[1]]=s))})),":hide"===n[b]()&&Boolean(isNaN(parseInt(s))?s:parseInt(s))&&(e[v].display="none"),[[":"+Y,Y],[":"+F,F],[":"+D,D],[":"+D+"-"+U,D+U],[":outline","outline"],[":box-sahdow","boxShadow"],[":bg-"+V,J+V],[":bg-"+x,J+x],[":bg-Blend-"+j,J+k+j],[":bg-"+X,J+X],[":bg-"+W,J+W],[":bg-"+z,J+z],[":bg-"+z+"-X",J+z+"X"],[":bg-"+z+"-Y",J+z+"Y"],[":bg-"+q,J+q],[":bg-"+$,J+$],[":bg-"+P,J+P],[":"+P,P[b]()]][K]((t=>{n[b]()===t[0][b]()&&(s[M]()[ne]<1?e[v][t[1]]=l:e[v][t[1]]=s)})),s[M]()[ne]<1?e.removeAttribute(`${n.replace(/^:/,"")}`):e.setAttribute(`${n.replace(/^:/,"")}`,s)}#d=(e,t={},n={})=>{(()=>{Object.keys(this.#n(e))[ue]((e=>/^@[\w]+$/.test(e)))[K]((t=>{const n=t.replace(/\@/,"on"),s=e.getAttribute(t);e.removeAttribute(t),null!=s&&(e[n]=this[S][s])}))})(),(()=>{if(!Boolean(n[re]))return;const s=(e.getAttribute(E)||"")[M](),l=(s[se](i)||[])[1],r=(s[se](o)||[])[1];Object.keys(this.#n(e))[ue]((e=>/^:@[\w]+$/.test(e)))[K]((s=>{const i=s.replace(/^\:\@/,"on");let o=(e.getAttribute(s)||"")[M]()[B](/\./)[ue]((e=>e[ne]>0))||[],u=t,a=o[0],c=u[a];o[le](),Boolean(n[ie])&&a!=l||Boolean(n[oe])&&a!=r||(c=this.#a(o,u,a,c),null!=c&&(e[i]=this[S][c]))}))})()};#h=(t,l={},r={})=>{const i=t.getAttribute(Te)||this.#t(16),o=(t.getAttribute(":once")||"")[M](),u=Boolean(isNaN(parseInt(o))?o:parseInt(o));t.setAttribute(Te,i);const a=t.cloneNode(!0),c=t.parentElement,T=he(t);if(null==T)return;const E=s.test(t[Q]);null!=parent&&0!=E&&[...t.childNodes][ue]((e=>e[m]===t&&e[te]===Node[ae]))[K]((t=>{((t[_]||"")[se](s)||[])[K]((s=>{const r=(s[se](n)||[])[1];if(null==r)return;const o=this.#u(r,l,(t=>{if(u)return;const n=e[ee].querySelector(Ee(i));null!=n&&null!=c&&(c.insertBefore(a.cloneNode(!0),c.children[T]),n[g](),this.#s(c,l))}));null!=o&&this.#f(t,r,o)}))}))};#A=(e,t={},n={})=>{const s=e.parentElement,l=(e.getAttribute(E)||"")[M](),r=(e.getAttribute(":once")||"")[M](),i=Boolean(isNaN(parseInt(r))?r:parseInt(r));if(null==s||l[ne]<1)return;const o=this.#t(16),a=e.cloneNode(!0);a.setAttribute(Te,o);const c=de("temp");if(null==c)return;const T=e.nextElementSibling;e[g]();const d=(l[se](/^\(?\s*(\w+)/)||[])[1],h=(l[se](/\,\s*(\w+)/)||[])[1],f=(l[se](u)||[])[1],A=this.#u(f,t,(e=>{const n=he(s.querySelector(Ee(o)));null!=n&&([...s.querySelectorAll(Ee(o))][K]((e=>e[g]())),s.insertBefore(a.cloneNode(!0),s.children[n]),this.#s(s,t,{[re]:!0}))}));Array[H](A)?A[K](((e,n)=>{const l=a.cloneNode(!0);c.appendChild(l);const r={[`${d}`]:e,[`${h}`]:n};"object"==typeof e&&null!=e?(Object.keys(e)[K]((n=>{this.#r(n,e,(()=>{if(i)return;const e=he(s.querySelector(Ee(o)));null!=e&&([...s.querySelectorAll(Ee(o))][K]((e=>e[g]())),s.insertBefore(a.cloneNode(!0),s.children[e]),this.#s(s,t,{[re]:!0}))}))})),this.#T(l,r),this.#d(l,r,{[re]:!0,[ie]:!0}),this.#p(l,r),this.#s(l,r,{[re]:!0})):(this.#T(l,r),this.#d(l,r,{[re]:!0,[ie]:!0}),this.#p(l,r))})):"object"==typeof A&&null!=A&&Object.keys(A)[K]((e=>{const n=a.cloneNode(!0);c.appendChild(n),this.#r(e,A,(()=>{if(i)return;const e=he(s.querySelector(Ee(o)));null!=e&&([...s.querySelectorAll(Ee(o))][K]((e=>e[g]())),s.insertBefore(a.cloneNode(!0),s.children[e]),this.#s(s,t,{[re]:!0}))}));const l=A[e],r={[`${d}`]:e,[`${h}`]:l};this.#T(n,r),this.#d(n,r,{[re]:!0,[oe]:!0}),this.#m(n,r),this.#s(n,r,{[re]:!0,[ie]:Array[H](l)})})),s.insertBefore(c,T)};#p=(e,t={})=>{const u=(e.getAttribute(E)||"")[M](),a=(u[se](i)||[])[1],c=(u[se](o)||[])[1],T=t[c];e.removeAttribute(E),[...e.childNodes][ue]((t=>t[m]===e&&t[te]===Node[ae]))[K]((e=>{((e[_]||"")[se](s)||[])[K]((s=>{const i=(s[se](n)||[])[1];if(null==i)return;const o=i[se](l),u=i[se](r),E=(o||[])[3],d=Number((o||[])[4]);let h=(null!=o?o[2]:i)[B](/\./),f=t,A=h[0],p=f[A];h[le](),null!=o&&A===a||null!=u&&A===a?p=this.#u(i,t)||"":A===a?p=this.#a(h,f,A,p):A===c&&(p=this.#l(T,E,d)),null!=p&&this.#f(e,i,p)}))})),this.#s(e,t,{[re]:!0})};#m=(e,t={})=>{const r=(e.getAttribute(E)||"")[M](),u=(r[se](i)||[])[1],a=(r[se](o)||[])[1];e.removeAttribute(E),[...e.childNodes][ue]((t=>t[m]===e&&t[te]===Node[ae]))[K]((e=>{((e[_]||"")[se](s)||[])[K]((s=>{let r=(s[se](n)||[])[1];if(null==r)return;const i=r[se](l),o=(i||[])[3],c=Number((i||[])[4]);let T=(null!=i?i[2]:r)[B](/\./),E=t,d=T[0],h=E[d];T[le](),null!=i&&d===a?h=this.#u(r,t)||"":d===a?h=this.#a(T,E,d,h):null!=i&&d===u&&(h=this.#l(h,o,c)),null!=h&&this.#f(e,r,h)}))})),this.#s(e,t,{[re]:!0})};#a(e,t,n,s){if(null!=s){for(;e[ne]>0;)s=s[e[0]],e[le]();return s}}#f(e,t,n){t=t.replace(/(\?|\.|\+|\*|\\|\%|\-|\(|\))/g,"\\$1");const s=new RegExp("{{\\s*?"+t+"\\s*?}}","i");n=(e[_]||"").replace(s,n)||"",e[_]=n}async#s(e,t={},n={}){if(e==this.dom&&(this.#T(e,t),this.#d(e,t,n),this.#h(e,t,n)),e.parentElement==this[I]&&null!=e.parentElement){const t=he(e);if(null==t)return;this[O][t]=!1}return await new Promise((s=>{if([...e.children][K]((async e=>{const s=this.#n(e);if(null!=e.parentElement&&null==s[h]&&null==s[f])if(s[T])this.#i(e,t,n);else{if(!s[E])return this.#o(e,t,n),this.#c(e,t),this.#T(e,t),this.#d(e,t,n),this.#h(e,t,n),await this.#s(e,t,n);this.#A(e,t,n)}})),e.classList.remove("dom-temp"),(e.parentElement==this[I]||e==this[I])&&null!=e.parentElement){const t=he(e);if(null==t)return;return this[O][t]=!0,s(e)}return null}))}}})()}("undefined"==typeof window?window={}:window);export const QUI = window.QUI;
